{% extends "cmsbase.html" %}
{% load compress static %}
{% block title %} {{block.super}} | CMS - Kundenauftrag {% endblock %}

{% block content %}


<div class="container mx-auto mt-8 max-w-5xl px-4">
    <div class="flex justify-between">
      <h1 class="text-xl"><a href="{% url 'cms:order-overview' %}" class="text-blue-500">Aufträge</a> / <span id="titleSpan">{{order.id}}</span></h1>
      <div>
        <a class="rounded bg-red-500 px-4 py-2 font-bold text-white hover:cursor-pointer hover:bg-red-700" id="deleteOrder"> Löschen </a>
      </div>
    </div>
    <h2 class="my-6 text-xl font-medium">Auftragsdetails</h2>
    <div id="galeryForm" class="w-full rounded-2xl bg-blue-50 px-4 py-2 shadow-lg">
      <div class="flex justify-between">
        <div class="space-y-1">
          <p class="font-medium">Auftragsnummer: #{{order.id}}</p>
          <p>{{order.created_at}}</p>
          <div class="flex space-x-1">
            <p class="w-fit rounded-2xl bg-yellow-400 px-2 text-sm font-medium text-gray-700">{{order.get_status_display}}</p>
            <p class="w-fit rounded-2xl bg-orange-400 px-2 text-sm font-medium text-gray-700">{{order.total}}€</p>
          </div>
        </div>
        <div class="flex items-center justify-center">
          <div class="relative h-10 w-40">
            <select id="status" class="border-blue-gray-200 text-blue-gray-700 placeholder-shown:border-blue-gray-200 placeholder-shown:border-t-blue-gray-200 disabled:bg-blue-gray-50 peer z-40 h-full w-full rounded-[7px] border border-t-transparent bg-transparent px-3 py-2.5 font-sans text-sm font-normal outline outline-0 transition-all placeholder-shown:border empty:!bg-red-500 focus:border-2 focus:border-blue-500 focus:border-t-transparent focus:outline-0 disabled:border-0">
              <option value="OPEN" {% if order.status == 'OPEN' %}selected{% endif %}>Offen</option>
              <option value="PAID" {% if order.status == 'PAID' %}selected{% endif %}>Bezahlt</option>
              <option value="SHIPPED" {% if order.status == 'SHIPPED' %}selected{% endif %}>Verschickt</option>
              <option value="COMPLETED" {% if order.status == 'COMPLETED' %}selected{% endif %}>Abgeschlossen</option>
            </select>
            <label class="before:content[' '] after:content[' '] text-blue-gray-400 before:border-blue-gray-200 after:border-blue-gray-200 peer-placeholder-shown:text-blue-gray-500 peer-disabled:peer-placeholder-shown:text-blue-gray-500 pointer-events-none absolute -top-1.5 left-0 flex h-full w-full select-none text-[11px] font-normal leading-tight transition-all before:pointer-events-none before:mr-1 before:mt-[6.5px] before:box-border before:block before:h-1.5 before:w-2.5 before:rounded-tl-md before:border-l before:border-t before:transition-all after:pointer-events-none after:ml-1 after:mt-[6.5px] after:box-border after:block after:h-1.5 after:w-2.5 after:flex-grow after:rounded-tr-md after:border-r after:border-t after:transition-all peer-placeholder-shown:text-sm peer-placeholder-shown:leading-[3.75] peer-placeholder-shown:before:border-transparent peer-placeholder-shown:after:border-transparent peer-focus:text-[11px] peer-focus:leading-tight peer-focus:text-blue-500 peer-focus:before:border-l-2 peer-focus:before:border-t-2 peer-focus:before:border-blue-500 peer-focus:after:border-r-2 peer-focus:after:border-t-2 peer-focus:after:border-blue-500 peer-disabled:text-transparent peer-disabled:before:border-transparent peer-disabled:after:border-transparent"> Status auswählen </label>
          </div>
          <button class="ml-2 rounded bg-green-500 px-4 py-2 font-medium text-white hover:cursor-pointer hover:bg-green-700" id="updateStatus"> Speichern </button>
        </div>
      </div>
      <!-- Order Info -->
      <div class="mt-6 grid grid-cols-2 gap-5">
        <!-- Kunden -->
        <div class="rounded-2xl bg-white p-2">
          <div class="flex">
            <div class="mr-2 h-fit rounded-full bg-slate-100 p-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
                <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z" />
              </svg>
            </div>
            <div>
              <h3 class="text-lg font-medium">Kunde</h3>
              <p class="text-sm text-slate-500">Name: <span class="text-black">/</span></p>
              <p class="text-sm text-slate-500">Email: <span class="text-black">{{order.buyer_email}}</span></p>
              <p class="text-sm text-slate-500">Telefon: <span class="text-black">/</span></p>
              <p class="text-sm text-slate-500">Adresse: <span class="text-black">{{order.buyer_address}}</span></p>
            </div>
          </div>
        </div>
        <!-- Auftrag -->
        <div class="rounded-2xl bg-white p-2">
          <div class="flex">
            <div class="mr-2 h-fit rounded-full bg-slate-100 p-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bag-check" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M10.854 8.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708 0" />
                <path d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1m3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1z" />
              </svg>
            </div>
            <div>
              <h3 class="text-lg font-medium">Auftrag</h3>
              <p class="text-sm text-slate-500">UUID: <span class="text-black">{{order.uuid}}</span></p>
              <p class="text-sm text-slate-500">Anzahl Produkte: <span class="text-black">{{order.items.count}}</span></p>
              <p class="text-sm text-slate-500">Anzahl Items: <span class="text-black">{{order.total_quantity}}</span></p>
              <p class="text-sm text-slate-500">Summe: <span class="text-green-700 font-semibold">{{order.total}}€</span></p>
            </div>
          </div>
        </div>
      </div>
      <!-- Order Item Table -->
      <div class="mt-8 max-h-screen space-y-2 overflow-auto rounded-2xl bg-white p-2 shadow-lg">
        <h2 class="text-lg font-medium">Produkte</h2>
        {% for item in order.items %}
        <div class="flex w-full justify-between rounded-2xl bg-slate-50 p-2">
          <div>
            <p class="text-sm text-gray-500">Produkt:</p>
            <p class="font-medium text-gray-700">{{item.product.title}}</p>
          </div>
          <div class="flex flex-col items-center">
            <p class="text-sm text-gray-500">Anzahl:</p>
            <p class="font-medium text-gray-700">{{item.quantity}}</p>
          </div>
          <div class="flex flex-col items-center">
            <p class="text-sm text-gray-500">Stückkosten</p>
            {% if item.is_discounted %}
            <p class="font-medium text-red-700">{{item.discounted_price}}€</p>
            {% else %}
            <p class="font-medium text-green-700">{{item.unit_price}}€</p>
            {% endif %}
          </div>
          <div class="flex flex-col items-center">
            <p class="text-sm text-gray-500">Umsatz</p>
            <p class="font-medium {% if item.is_discounted %}text-red-700{% else %}text-green-700{% endif %}">{{item.subtotal}}€</p>
          </div>
          <div class="flex flex-col items-center">
            <p class="text-sm text-gray-500">Reduziert?</p>
            <p class="font-medium text-gray-700">{% if item.is_discounted %}Ja{% else %}Nein{% endif %}</p>
          </div>
          <div class="flex flex-col items-center justify-center">
            <a href="#" class="rounded-2xl bg-red-500 p-2 text-white">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z" />
                <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z" />
              </svg>
            </a>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
  


{% block javascriptend %}
{% compress js inline %}
<script src="{% static 'js/cms/orders/order.js' %}"></script>
{% endcompress js %}
{% endblock javascriptend %}

{% endblock content %}